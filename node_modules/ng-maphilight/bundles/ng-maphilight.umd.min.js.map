{"version":3,"sources":["ng://ng-maphilight/lib/maphilight.service.ts","ng://ng-maphilight/lib/maphilight.component.ts","ng://ng-maphilight/lib/maphilight.module.ts"],"names":["MaphilightService","Injectable","args","providedIn","MaphilightComponent","elRef","differs","this","events","imgLoaded","Subject","updateMaphilight","el","nativeElement","configDiffer","find","create","prototype","ngAfterViewInit","_this","img","querySelector","map","id","getAttribute","setAttribute","onload","next","window","jQuery","maphilight","configToApply","ngDoCheck","diff","config","Object","assign","strokeColor","substr","fillColor","shadowColor","Component","selector","template","ElementRef","KeyValueDiffers","Input","MaphilightModule","NgModule","imports","CommonModule","declarations","exports"],"mappings":"6WAAA,IAAAA,EAAA,WAOE,SAAAA,gCALDC,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,wJAHd,GCAAC,EAAA,WAkCE,SAAAA,EACUC,EACRC,GADQC,KAAAF,MAAAA,EANVE,KAAAC,OAAS,CACPC,UAAW,IAAIC,EAAAA,QACfC,iBAAkB,IAAID,EAAAA,SAOtBH,KAAKK,GAAKL,KAAKF,MAAMQ,cACrBN,KAAKO,aAAeR,EAAQS,KAAK,IAAIC,SA2CzC,OAxCEZ,EAAAa,UAAAC,gBAAA,WAAA,IAAAC,EAAAZ,KACEA,KAAKa,IAAMb,KAAKK,GAAGS,cAAc,OACjCd,KAAKe,IAAMf,KAAKK,GAAGS,cAAc,WAC3BE,EAAKhB,KAAKK,GAAGY,aAAa,MAChCjB,KAAKa,IAAIK,aAAa,SAAU,IAAMF,EAAK,QAC3ChB,KAAKe,IAAIG,aAAa,KAAgBF,EAAK,QAC3ChB,KAAKe,IAAIG,aAAa,OAAgBF,EAAK,QAK3ChB,KAAKa,IAAIM,OAAM,WACbP,EAAKX,OAAOC,UAAUkB,OACtBR,EAAKR,qBAITP,EAAAa,UAAAN,iBAAA,WACOJ,KAAKa,MACVb,KAAKC,OAAOG,iBAAiBgB,OAC7BC,OAAOC,OAAOtB,KAAKa,KAAKU,WAAWvB,KAAKwB,mBAG1C3B,EAAAa,UAAAe,UAAA,WACkBzB,KAAKO,aAAamB,KAAK1B,KAAK2B,SAE1C3B,KAAKI,oBAIDP,EAAAa,UAAAc,cAAR,eACQG,EAASC,OAAOC,OAAO,GAAI7B,KAAK2B,QAOtC,OANIA,EAAOG,aAAwC,KAAzBH,EAAOG,YAAY,KAC3CH,EAAOG,YAAcH,EAAOG,YAAYC,OAAO,IAC7CJ,EAAOK,WAAoC,KAAvBL,EAAOK,UAAU,KACvCL,EAAOK,UAAYL,EAAOK,UAAUD,OAAO,IACzCJ,EAAOM,aAAwC,KAAzBN,EAAOM,YAAY,KAC3CN,EAAOM,YAAcN,EAAOM,YAAYF,OAAO,IAC1CJ,uBA9DVO,EAAAA,UAASvC,KAAA,CAAC,CACTwC,SAAU,aACVC,SAAA,yFAhBAC,EAAAA,kBACSC,EAAAA,mDAmBRC,EAAAA,SA0DH1C,EAlFA,gBCMA,SAAA2C,KAOgC,2BAP/BC,EAAAA,SAAQ9C,KAAA,CAAC,CACR+C,QAAS,CACPC,EAAAA,cAEFC,aAAc,CAAC/C,GACfgD,QAAc,CAAChD,OAEe2C","sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MaphilightService {\n\n  constructor() { }\n}\n","import {\n  Component,\n  Input,\n  AfterContentInit, AfterViewInit,\n  ElementRef,\n  DoCheck, KeyValueDiffers, KeyValueDiffer,\n} from '@angular/core';\nimport { Subject } from 'rxjs';\n\ndeclare global {\n  interface Window {\n    jQuery: any;\n  }\n  interface JQuery {\n    maphilight(options?: any): any;\n  }\n}\n\n@Component({\n  selector: 'maphilight',\n  templateUrl: './maphilight.component.html',\n  styleUrls: ['./maphilight.component.css']\n})\nexport class MaphilightComponent implements AfterViewInit {\n  @Input() config: any;\n  configDiffer: KeyValueDiffer<any, any>;\n  el:  HTMLElement;\n  img: HTMLImageElement;\n  map: HTMLMapElement;\n  events = {\n    imgLoaded: new Subject<undefined>(),\n    updateMaphilight: new Subject<any>(),\n  }\n\n  constructor(\n    private elRef: ElementRef,\n    differs: KeyValueDiffers\n  ) {\n    this.el = this.elRef.nativeElement;\n    this.configDiffer = differs.find({}).create();\n  }\n\n  ngAfterViewInit() {\n    this.img = this.el.querySelector('img');\n    this.map = this.el.querySelector('map');\n    const id = this.el.getAttribute('id')\n    this.img.setAttribute('usemap', '#' + id + \".map\");\n    this.map.setAttribute('id',           id + \".map\");\n    this.map.setAttribute('name',         id + \".map\");\n\n    // Wait until image is loaded. Otherwise the $(img).height() in maphilight.js may return 0,\n    // which causes mouseover effect to break.\n    // See also  https://stackoverflow.com/questions/16084374/jquery-width-and-height-return-0-for-img-element\n    this.img.onload = () => {\n      this.events.imgLoaded.next()\n      this.updateMaphilight();\n    }\n  }\n\n  updateMaphilight() {\n    if (!this.img) return;\n    this.events.updateMaphilight.next()\n    window.jQuery(this.img).maphilight(this.configToApply());\n  };\n\n  ngDoCheck() {\n    const changes = this.configDiffer.diff(this.config)\n    if (changes) {\n      this.updateMaphilight()\n    }\n  }\n\n  private configToApply() {\n    const config = Object.assign({}, this.config)\n    if (config.strokeColor && config.strokeColor[0] == '#')\n      config.strokeColor = config.strokeColor.substr(1)\n    if (config.fillColor && config.fillColor[0] == '#')\n      config.fillColor = config.fillColor.substr(1)\n    if (config.shadowColor && config.shadowColor[0] == '#')\n      config.shadowColor = config.shadowColor.substr(1)\n    return config\n  }\n}\n\n","//   import { FormsModule }   from '@angular/forms'\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaphilightComponent } from './maphilight.component';\nexport { MaphilightComponent } from './maphilight.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [MaphilightComponent],\n  exports:      [MaphilightComponent]\n})\nexport class MaphilightModule { }\n"]}