{"version":3,"file":"ng-maphilight.js","sources":["ng://ng-maphilight/lib/maphilight.service.ts","ng://ng-maphilight/lib/maphilight.component.ts","ng://ng-maphilight/lib/maphilight.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MaphilightService {\n\n  constructor() { }\n}\n","import {\n  Component,\n  Input,\n  AfterContentInit, AfterViewInit,\n  ElementRef,\n  DoCheck, KeyValueDiffers, KeyValueDiffer,\n} from '@angular/core';\nimport { Subject } from 'rxjs';\n\ndeclare global {\n  interface Window {\n    jQuery: any;\n  }\n  interface JQuery {\n    maphilight(options?: any): any;\n  }\n}\n\n@Component({\n  selector: 'maphilight',\n  templateUrl: './maphilight.component.html',\n  styleUrls: ['./maphilight.component.css']\n})\nexport class MaphilightComponent implements AfterViewInit {\n  @Input() config: any;\n  configDiffer: KeyValueDiffer<any, any>;\n  el:  HTMLElement;\n  img: HTMLImageElement;\n  map: HTMLMapElement;\n  events = {\n    imgLoaded: new Subject<undefined>(),\n    updateMaphilight: new Subject<any>(),\n  }\n\n  constructor(\n    private elRef: ElementRef,\n    differs: KeyValueDiffers\n  ) {\n    this.el = this.elRef.nativeElement;\n    this.configDiffer = differs.find({}).create();\n  }\n\n  ngAfterViewInit() {\n    this.img = this.el.querySelector('img');\n    this.map = this.el.querySelector('map');\n    const id = this.el.getAttribute('id')\n    this.img.setAttribute('usemap', '#' + id + \".map\");\n    this.map.setAttribute('id',           id + \".map\");\n    this.map.setAttribute('name',         id + \".map\");\n\n    // Wait until image is loaded. Otherwise the $(img).height() in maphilight.js may return 0,\n    // which causes mouseover effect to break.\n    // See also  https://stackoverflow.com/questions/16084374/jquery-width-and-height-return-0-for-img-element\n    this.img.onload = () => {\n      this.events.imgLoaded.next()\n      this.updateMaphilight();\n    }\n  }\n\n  updateMaphilight() {\n    if (!this.img) return;\n    this.events.updateMaphilight.next()\n    window.jQuery(this.img).maphilight(this.configToApply());\n  };\n\n  ngDoCheck() {\n    const changes = this.configDiffer.diff(this.config)\n    if (changes) {\n      this.updateMaphilight()\n    }\n  }\n\n  private configToApply() {\n    const config = Object.assign({}, this.config)\n    if (config.strokeColor && config.strokeColor[0] == '#')\n      config.strokeColor = config.strokeColor.substr(1)\n    if (config.fillColor && config.fillColor[0] == '#')\n      config.fillColor = config.fillColor.substr(1)\n    if (config.shadowColor && config.shadowColor[0] == '#')\n      config.shadowColor = config.shadowColor.substr(1)\n    return config\n  }\n}\n\n","//   import { FormsModule }   from '@angular/forms'\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MaphilightComponent } from './maphilight.component';\nexport { MaphilightComponent } from './maphilight.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [MaphilightComponent],\n  exports:      [MaphilightComponent]\n})\nexport class MaphilightModule { }\n"],"names":[],"mappings":"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"}